# Today

- [Kotlin] Download APK from url and install it
- [Kotlin] Download files from url and move them to '/storage/emulated/0/'
- [React] Ditto homepage

## React

### Some amazing examples

- [React Router Example](https://stackblitz.com/edit/github-agqlf5?file=src%2FApp.jsx)

## Kotlin

### MsgUtil

``` kotlin
object MsgUtil {
    private var progressing: Progressing? = null

    fun showProgress(ctx: Context, msg: String) {
        progressing = Progressing.newInstance(msg)
        progressing?.isCancelable = false
        progressing?.show((ctx as FragmentActivity).supportFragmentManager, "TAG")
    }

    fun dismissProgress() {
        progressing?.let{it.dismiss()}
    }

    fun showMsg(ctx: Context, title: String, msg: String, f: (() -> Unit)? = null) {
        val alertDialog: AlertDialog? = ctx?.let {
            val builder = AlertDialog.Builder(it)
            builder.apply {
                setTitle(title)
                setMessage(msg)
                setPositiveButton(R.string.ok) { _, _ ->
                    // OKボタンを押したイベント
                    if (f != null) { f() }
                }
            }
            builder.create()
        }

        alertDialog!!.setOnShowListener {
            val btn: Button = alertDialog!!.getButton(AlertDialog.BUTTON_POSITIVE)
            btn.isFocusable = true
            btn.isFocusableInTouchMode = true
            btn.requestFocus()
        }
        alertDialog?.show()
    }

    fun showMsg(ctx: Context, msg: String) {
        showMsg(ctx, "", msg)
    }

    fun showQuestion(ctx: Context,
                     title: String, msg: String,
                     doPositive: Unit? = null,
                     doNegative: (() -> Unit)? = null) {
        val alertDialog: AlertDialog? = ctx?.let {
            val builder = AlertDialog.Builder(it)
            builder.apply {
                setTitle(title)
                setMessage(msg)
                setPositiveButton(R.string.ok) { _, _ ->
                    doPositive
                }
                setNegativeButton(R.string.cancel) { _, _ ->
                    if (doNegative != null) { doNegative() }
                }
            }
            builder.create()
        }

        alertDialog!!.setOnShowListener {
            val btn: Button = alertDialog!!.getButton(AlertDialog.BUTTON_POSITIVE)
            btn.isFocusable = true
            btn.isFocusableInTouchMode = true
            btn.requestFocus()
        }
        alertDialog?.show()
    }

    fun showToast(ctx: Context, content: String, isShort: Boolean = true) {
        Toast.makeText(ctx, content, if (isShort) Toast.LENGTH_SHORT else Toast.LENGTH_LONG).show()
    }

    fun setProgressDialog(ctx: Context) {
        val llPadding = 30
        val ll = LinearLayout(ctx)
        ll.orientation = LinearLayout.HORIZONTAL
        ll.setPadding(llPadding, llPadding, llPadding, llPadding)
        ll.gravity = Gravity.CENTER
        var llParam = LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.WRAP_CONTENT,
            LinearLayout.LayoutParams.WRAP_CONTENT
        )
        llParam.gravity = Gravity.CENTER
        ll.layoutParams = llParam
        val progressBar = ProgressBar(ctx)
        progressBar.isIndeterminate = true
        progressBar.setPadding(0, 0, llPadding, 0)
        progressBar.layoutParams = llParam
        llParam = LinearLayout.LayoutParams(
            ViewGroup.LayoutParams.WRAP_CONTENT,
            ViewGroup.LayoutParams.WRAP_CONTENT
        )
        llParam.gravity = Gravity.CENTER
        val tvText = TextView(ctx)
        tvText.text = "Loading ..."
        tvText.setTextColor(Color.parseColor("#000000"))
        tvText.textSize = 20f
        tvText.layoutParams = llParam
        ll.addView(progressBar)
        ll.addView(tvText)
        val builder = AlertDialog.Builder(ctx)
        builder.setCancelable(true)
        builder.setView(ll)
        val dialog = builder.create()
        dialog.show()
        val window: Window? = dialog.window
        if (window != null) {
            val layoutParams = WindowManager.LayoutParams()
            layoutParams.copyFrom(dialog.window!!.attributes)
            layoutParams.width = LinearLayout.LayoutParams.WRAP_CONTENT
            layoutParams.height = LinearLayout.LayoutParams.WRAP_CONTENT
            dialog.window!!.attributes = layoutParams
        }
    }
}
```

### Progressing

``` kotlin
class Progressing : DialogFragment() {
    companion object {
        fun newInstance(message: String): Progressing {
            val instance = Progressing()
            val arguments = Bundle()
            arguments.putString("message", message)
            instance.arguments = arguments
            return instance
        }
    }

    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
        val mMessage = requireArguments().getString("message")

        val builder = AlertDialog.Builder(requireActivity())
        val inflater = requireActivity().layoutInflater
        val view = inflater.inflate(R.layout.dialog_progress, null)
        val mMessageTextView = view.findViewById(R.id.progress_message) as TextView
        mMessageTextView.text = mMessage
        builder.setView(view)
        return builder.create()
    }
}
```
